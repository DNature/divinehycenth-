<!DOCTYPE html><html lang="en"><head><link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,400;1,500&amp;display=swap" rel="stylesheet"/><script>
							window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());

              gtag('config', 'UA-145785346-1');
						</script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Handling File Uploads with Apollo Server 2.0.</title><meta property="twitter:image:src" content="https://divinehycenth.com/images/blog/file-uploads-with-apolloserver-2/thumbnail.png"/><meta name="yandex-verification" content="8caa5bda2d4a0bba"/><link rel="canonical" href="https://divinehycenth.com"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="title" content="Handling File Uploads with Apollo Server 2.0."/><meta name="description" content="A comprehensive guide on how to upload files with Apollo-server 2.0 and Mongodb.."/><meta name="theme-color" content="#6b0ce3"/><meta itemProp="name" content="Handling File Uploads with Apollo Server 2.0."/><meta itemProp="description" content="A comprehensive guide on how to upload files with Apollo-server 2.0 and Mongodb.."/><meta itemProp="image" content="https://divinehycenth.com/images/blog/file-uploads-with-apolloserver-2/thumbnail.png"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta property="og:url" content="https://divinehycenth.com/blog/2020-02-02_file-uploads-with-apolloserver-2-md/"/><meta property="og:title" content="Handling File Uploads with Apollo Server 2.0."/><meta property="og:description" content="A comprehensive guide on how to upload files with Apollo-server 2.0 and Mongodb.."/><meta name="og:site_name" content="Divine Hycenth - Blog Website"/><meta property="og:image:width" content="1000"/><meta property="og:image:height" content="532"/><meta property="og:image" content="https://divinehycenth.com/images/blog/file-uploads-with-apolloserver-2/thumbnail.png"/><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:url" content="https://divinehycenth.com/blog/2020-02-02_file-uploads-with-apolloserver-2-md/"/><meta property="twitter:title" content="Handling File Uploads with Apollo Server 2.0."/><meta property="twitter:description" content="A comprehensive guide on how to upload files with Apollo-server 2.0 and Mongodb.."/><meta name="twitter:site" content="https://twitter.com/DivineHycenth"/><meta name="twitter:creator" content="@DivineHycenth"/><meta name="fb:admins" content="https://facebook.com/divine.hycenth.7"/><meta name="fb:app_id" content="https://facebook.com/divine.hycenth.7"/><link href="https://fonts.googleapis.com/css2?family=Fira+Code&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Satisfy&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&amp;display=swap" rel="stylesheet"/><link rel="shortcut icon" href="/images/icons/favicons/favicon.ico"/><link rel="icon" type="image/ico" href="/images/icons/favicons/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/images/icons/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicons/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><meta name="next-head-count" content="39"/><link rel="preload" href="/_next/static/css/37dbc037ad4bfc9ce8cb.css" as="style" crossorigin="anonymous"/><link rel="stylesheet" href="/_next/static/css/37dbc037ad4bfc9ce8cb.css" crossorigin="anonymous"/><link rel="preload" href="/_next/static/mQTtxJh6cp0PLSlqOD3x2/pages/blog/2020-02-02_file-uploads-with-apolloserver-2.module.js" as="script" crossorigin="anonymous"/><link rel="preload" href="/_next/static/mQTtxJh6cp0PLSlqOD3x2/pages/_app.module.js" as="script" crossorigin="anonymous"/><link rel="preload" href="/_next/static/chunks/95b64a6e.320b368289cb716b3186.module.js" as="script" crossorigin="anonymous"/><link rel="preload" href="/_next/static/chunks/70b165ca.5eabe1f989279afc56a7.module.js" as="script" crossorigin="anonymous"/><link rel="preload" href="/_next/static/runtime/webpack-6b61ba7e8cc83693bf8f.module.js" as="script" crossorigin="anonymous"/><link rel="preload" href="/_next/static/chunks/framework.9549779569dd0a6219bc.module.js" as="script" crossorigin="anonymous"/><link rel="preload" href="/_next/static/chunks/commons.38ae1a63b556c62a43bb.module.js" as="script" crossorigin="anonymous"/><link rel="preload" href="/_next/static/runtime/main-bff67df7d47595de3d7b.module.js" as="script" crossorigin="anonymous"/><link rel="preload" href="/_next/static/chunks/79a3735623e6ec13153dc6c81bde6dd3a2ce1fd5.cb733fe248004940673c.module.js" as="script" crossorigin="anonymous"/><link rel="preload" href="/_next/static/chunks/bc2128e0aae8cc24d1deb12f225fceae6d5349d9.43d63eaf1e9ba971f319.module.js" as="script" crossorigin="anonymous"/><link rel="preload" href="/_next/static/chunks/363a1f4813caa0a77838ebfcb6ec3f2bb88305a2.0f1a051ba58adbbdf01c.module.js" as="script" crossorigin="anonymous"/></head><body class="light"><div id="__next"><div class="relative flex flex-col h-full" style="height:100vh"><div class="py-4 justify-center z-20 fixed top-0 left-0 w-full hidden sm:flex false"><nav class="flex content-center "><a class="my-auto" href="/"><img src="/images/icons/logo.svg" alt="Logo" class="h-16 mr-10  transition-all duration-200"/></a><a class="py-2 mr-6 text-white font-semibold block" href="/about/">About</a><a class="py-2 mr-6 text-white font-semibold block" href="/blog/">Blog<span class="block mt-3 w-5 h-1 mx-auto text-center bg-white rounded"></span></a><a class="py-2 mr-6 text-white font-semibold block" href="/works/">Works</a><a class="py-2 mr-6 text-white font-semibold block" href="/contact/">Contact</a></nav></div><div class="z-20 fixed top-0 left-0 w-full py-0 flex flex-col sm:hidden false"><div class="flex justify-between p-4"><a href="/"><img src="/images/icons/logo.svg" alt="Logo" class="h-12  transition-all duration-200"/></a><button><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="text-white text-2xl my-auto" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button></div></div><nav data-isopen="false" class="fixed top-0 left-0 w-full z-50 py-6 h-screen overflow-hidden gradient translate-x-56 flex flex-col" style="transform:translateX(-100%);transition:transform 0.25s ease-in-out"><div class="flex px-4 justify-between"><a href="/"><img src="/images/icons/logo.svg" alt="Logo" class="h-10"/></a><button><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="text-white text-2xl my-auto" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z"></path></svg></button></div><hr class="my-6"/><span class="flex-1"><a class="py-2 mr-6 text-white font-semibold block p-2 hover mx-4" href="/about/"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline-block text-xl text-white" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>About</a><a class="py-2 mr-6 text-white font-semibold block p-2 hover mx-4" href="/blog/"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline-block text-xl text-white" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"></path><line x1="16" y1="8" x2="2" y2="22"></line><line x1="17.5" y1="15" x2="9" y2="15"></line></svg>Blog<span class="block mt-3 w-full h-1 mx-auto text-center bg-white rounded bg-gray-400"></span></a><a class="py-2 mr-6 text-white font-semibold block p-2 hover mx-4" href="/works/"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline-block text-xl text-white" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>Works</a><a class="py-2 mr-6 text-white font-semibold block p-2 hover mx-4" href="/contact/"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline-block text-xl text-white" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>Contact</a></span><hr class="my-6"/><div class="flex justify-between w-full px-4 mx-auto" style="justify-self:flex-start"><a class="text-white font-semibold block hover mx-4" target="_blank" href="/about/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="text-xl text-white" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 32C132.3 32 32 134.9 32 261.7c0 101.5 64.2 187.5 153.2 217.9 1.4.3 2.6.4 3.8.4 8.3 0 11.5-6.1 11.5-11.4 0-5.5-.2-19.9-.3-39.1-8.4 1.9-15.9 2.7-22.6 2.7-43.1 0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1 1.4-14.1h.1c22.5 2 34.3 23.8 34.3 23.8 11.2 19.6 26.2 25.1 39.6 25.1 10.5 0 20-3.4 25.6-6 2-14.8 7.8-24.9 14.2-30.7-49.7-5.8-102-25.5-102-113.5 0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8 0 0 1.6-.5 5-.5 8.1 0 26.4 3.1 56.6 24.1 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 30.2-21 48.5-24.1 56.6-24.1 3.4 0 5 .5 5 .5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6 0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5 0 30.7-.3 55.5-.3 63 0 5.4 3.1 11.5 11.4 11.5 1.2 0 2.6-.1 4-.4C415.9 449.2 480 363.1 480 261.7 480 134.9 379.7 32 256 32z"></path></svg></a><a class="text-white font-semibold block hover mx-4" target="_blank" href="/blog/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="text-xl text-white" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M492 109.5c-17.4 7.7-36 12.9-55.6 15.3 20-12 35.4-31 42.6-53.6-18.7 11.1-39.4 19.2-61.5 23.5C399.8 75.8 374.6 64 346.8 64c-53.5 0-96.8 43.4-96.8 96.9 0 7.6.8 15 2.5 22.1-80.5-4-151.9-42.6-199.6-101.3-8.3 14.3-13.1 31-13.1 48.7 0 33.6 17.2 63.3 43.2 80.7-16-.4-31-4.8-44-12.1v1.2c0 47 33.4 86.1 77.7 95-8.1 2.2-16.7 3.4-25.5 3.4-6.2 0-12.3-.6-18.2-1.8 12.3 38.5 48.1 66.5 90.5 67.3-33.1 26-74.9 41.5-120.3 41.5-7.8 0-15.5-.5-23.1-1.4C62.8 432 113.7 448 168.3 448 346.6 448 444 300.3 444 172.2c0-4.2-.1-8.4-.3-12.5C462.6 146 479 129 492 109.5z"></path></svg></a><a class="text-white font-semibold block hover mx-4" target="_blank" href="/works/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="text-xl text-white" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z"></path></svg></a><a class="text-white font-semibold block hover mx-4" target="_blank" href="/contact/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="text-xl text-white" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 64C150 64 64 150 64 256c0 106.1 86 192 192 192s192-85.9 192-192c0-106-86-192-192-192zm121.9 88.5c21.6 25.4 35.3 57.6 37.7 92.9-34.6-1.8-76-1.8-109.2 1.3-4.2-10.6-8.5-21-13.2-31 38.3-16.6 67.8-38.4 84.7-63.2zM256 96c38.8 0 74.4 13.8 102.1 36.8-17.4 22-44.7 41.1-78.7 55.6-18.6-34.4-40-64-62.8-87.3 12.7-3.2 25.8-5.1 39.4-5.1zm-72.4 17.5c23.1 23 44.8 52.3 63.8 86.6-36.1 11-77.5 17.3-121.7 17.3-8.4 0-16.6-.3-24.7-.8 11.5-45.1 42-82.5 82.6-103.1zM96.3 248.4c9.1.4 18.3.6 27.6.5 50.4-.6 97.3-8.5 137.6-21.4 3.8 7.9 7.4 16 10.8 24.3-5.5 1.3-10.4 2.7-14.3 4.3-55.1 23.1-98.5 60.4-122 105.5-24.8-28.2-40-65.1-40-105.6 0-2.6.1-5.1.3-7.6zM256 416c-37 0-71-12.6-98.1-33.7 21.3-42.2 59.3-77.1 107.2-98.8 4.5-2.1 10.5-3.8 17.4-5.3 5.7 15.8 10.8 32.2 15.3 49.2 6.9 26.5 11.8 52.7 14.8 78.1C295 412.2 276 416 256 416zm86.5-25.5c-3-25.7-7.9-52.1-14.9-78.9-3.4-13-7.3-25.6-11.5-37.9 31.4-2.6 69-2.2 98.9 0-5.4 49.1-33 91.3-72.5 116.8z"></path></svg></a><a class="text-white font-semibold block hover mx-4" target="_blank" href="//stackoverflow.com"><svg stroke="currentColor" fill="currentColor" stroke-width="0" version="1.1" viewBox="0 0 32 32" class="text-xl text-white" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M6.080 23.835v5.32h16.767v-10.673l-0.871 0.097-0.903 0.097-0.097 4.417-0.097 4.45h-13.188v-9.028h-1.612v5.32zM8.982 24.641v0.967h10.318v-1.935h-10.318v0.967zM9.137 20.832l-0.105 0.962 10.257 1.118 0.21-1.923-10.257-1.118-0.105 0.962zM9.908 16.282l-0.251 0.934 9.965 2.676 0.502-1.868-9.965-2.676-0.251 0.934zM12.024 10.978l-0.515 0.819 8.734 5.494 1.030-1.638-8.734-5.494-0.515 0.819zM16.965 6.038l-0.797 0.549 5.853 8.498 1.593-1.097-5.853-8.498-0.797 0.549zM23.413 3.549l-0.951 0.177 1.893 10.143 1.902-0.355-1.892-10.143-0.951 0.177z"></path></svg></a></div><div class="col-span-6 text-center mt-6"><p class="text-g-50 text-sm">Â© Copyright 2020. divinehycenth.com</p></div></nav><div class="flex-1 z-10 relative"><div class="w-full gradient relative -z-10 after after-2"><div class="w-full h-full overflow-hidden absolute top-0 left-0 -z-5"><div class="gradient-alt circle absolute"></div></div><div class="absolute h-full w-full left-0 top-0 opacity-25 -z-4" style="background:url(/images/blog/file-uploads-with-apolloserver-2/thumbnail.png);background-position:center 30%;background-size:cover"></div><div class="container md:pt-56 pt-32"><h1 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-white lg:w-3/5">Handling File Uploads with Apollo Server 2.0.</h1><time dateTime="2020-02-02" class="text-xs mg:text-sm text-white">Feb 2, 2020</time><div class="mt-4 flex pb-64 z-auto"><button class="bg-g-15 sm:inline-block rounded-full px-3 font-bold text-g-75 text-sm hover:opacity cursor-pointer mr-2 mt-4 hidden" style="color:#efefef;background-color:#D71EC4">#<!-- -->graphql</button><button class="bg-g-15 sm:inline-block rounded-full px-3 font-bold text-g-75 text-sm hover:opacity cursor-pointer mr-2 mt-4 hidden" style="color:#12181a;background-color:#90c53f">#<!-- -->nodejs</button><button class="bg-g-15 sm:inline-block rounded-full px-3 font-bold text-g-75 text-sm hover:opacity cursor-pointer mr-2 mt-4 hidden" style="color:var(text);background-color:var(--gray4)">#<!-- -->upload</button></div></div></div><article class="container -mt-48 bg rounded-lg"><style data-emotion-css="7xemd4">body{color:var(--theme-ui-colors-text,var(--text));background-color:var(--theme-ui-colors-background,var(--bg));}</style><style data-emotion-css="96727g">*{box-sizing:border-box;}body{margin:0;font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;line-height:1.5;font-weight:400;}</style><div class="max-w-2xl mx-auto py-8"><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh"><style data-emotion-css="9whsf3">.css-9whsf3{max-width:100%;}</style><img src="/images/blog/file-uploads-with-apolloserver-2/thumbnail.png" alt="Handling file uploads with apollo server 2.0" class="css-9whsf3"/></p><style data-emotion-css="1o4q193">.css-1o4q193{font-family:inherit;line-height:1.125;font-weight:400;margin-bottom:1rem;margin-top:2.9rem;font-size:38px;}</style><h2 class="css-1o4q193">A comprehensive guide on how to upload files with Apollo-server 2.0 and Mongodb.</h2><style data-emotion-css="1k7sbs7">.css-1k7sbs7{font-family:inherit;line-height:1.125;font-weight:700;margin-bottom:1rem;margin-top:2.5rem;font-size:24px;}</style><h3 class="css-1k7sbs7">Prerequisites</h3><ul class="css-0"><style data-emotion-css="1g3n8wz">.css-1g3n8wz code{font-family:Menlo,monospace;background-color:#21262d;padding:3px 5px;border-radius:4px;font-size:16px;color:#9EFEFF;}</style><li class="css-1g3n8wz"><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh"><style data-emotion-css="mwt03k">.css-mwt03k{color:var(--primary0);}.css-mwt03k:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://altair.sirmuel.design/" class="css-mwt03k">Altair</a> (Recommended alternative to the default graphql playground)</p></li><li class="css-1g3n8wz"><p class="css-2o3vvh">You must have <a href="https://nodejs.org" class="css-mwt03k">nodejs</a> installed on your machine.</p></li><li class="css-1g3n8wz"><p class="css-2o3vvh">Basic knowledge of <strong class="css-0">nodejs</strong></p></li></ul><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">File Uploads have an interesting history in the Apollo ecosystem.</p><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">With Apollo Server 2.0, you can perform file uploads right out of the box. Apollo Server ships with the ability to handle multipart requests that contain file data. This means you can send a mutation to Apollo Server containing a file, pipe it to the filesystem, or pipe it to a cloud storage provider instead.</p><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Depending on your problem domain and your use case, the way you set up file uploads may differ. Handling Multipart upload request in graphql can be a pain in the ass especially when your are coming from a <strong class="css-0">Rest</strong> background like me. However, I&#x27;m going to show you how to upload files with <strong class="css-0">apollo-server 2.0 </strong></p><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">One of the simplest ways of achieving file uploads in a single request is to base64-encode a file and send as a string variable in a mutation.</p><style data-emotion-css="1o4q193">.css-1o4q193{font-family:inherit;line-height:1.125;font-weight:400;margin-bottom:1rem;margin-top:2.9rem;font-size:38px;}</style><h2 class="css-1o4q193">How it works</h2><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">The upload functionality follows the GraphQL multipart form requests specification. Two parts are needed to make the upload work correctly. The server and the client:</p><ul class="css-0"><style data-emotion-css="1g3n8wz">.css-1g3n8wz code{font-family:Menlo,monospace;background-color:#21262d;padding:3px 5px;border-radius:4px;font-size:16px;color:#9EFEFF;}</style><li class="css-1g3n8wz"><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh"><strong class="css-0">The Client:</strong> On the client, file objects are mapped into a mutation and sent to the server in a multipart request.</p></li><li class="css-1g3n8wz"><p class="css-2o3vvh"><strong class="css-0">The Server:</strong> The multipart request is received. The server processes it and provides an upload argument to a resolver. In the resolver function, the upload promise resolves an object.</p></li></ul><style data-emotion-css="1o4q193">.css-1o4q193{font-family:inherit;line-height:1.125;font-weight:400;margin-bottom:1rem;margin-top:2.9rem;font-size:38px;}</style><h2 class="css-1o4q193">Our project structure</h2><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="prism-code language-css-164t1yn css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token plain css-1baulvz">â”œâ”€â”€ images</span></div><div class="token-line"><span class="token plain css-1baulvz">â”‚   â””â”€â”€ 9A1ufNLv-bg-works.jpg</span></div><div class="token-line"><span class="token plain css-1baulvz">â”œâ”€â”€ package.json</span></div><div class="token-line"><span class="token plain css-1baulvz">â””â”€â”€ src</span></div><div class="token-line"><span class="token plain css-1baulvz">    â”œâ”€â”€ db.js</span></div><div class="token-line"><span class="token plain css-1baulvz">    â”œâ”€â”€ fileModel.js</span></div><div class="token-line"><span class="token plain css-1baulvz">    â”œâ”€â”€ index.js</span></div><div class="token-line"><span class="token plain css-1baulvz">    â”œâ”€â”€ resolvers.js</span></div><div class="token-line"><span class="token plain css-1baulvz">    â””â”€â”€ typeDefs.js</span></div></pre><br/><style data-emotion-css="1o4q193">.css-1o4q193{font-family:inherit;line-height:1.125;font-weight:400;margin-bottom:1rem;margin-top:2.9rem;font-size:38px;}</style><h2 class="css-1o4q193">Lets Begin ðŸš€</h2><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">We will start off by initializing our project with npm, install the necessary packages and configure our server.</p><br/><div class="bar bg-black z-10 flex justify-between pr-4 overflow-hidden"><div class="btns"></div><div class="my-auto flex"><p class="text-white mr-2">$ </p><p class="name text-gray-500 text-base font-sans font-bold" style="color:#ffffff">$~ bash</p></div></div><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="language-bash prism-code language-bash css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token function css-1baulvz">npm</span><span class="token plain css-1baulvz"> init -y</span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token function css-1baulvz">yarn</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">add</span><span class="token plain css-1baulvz"> esm apollo-server graphql mongoose shortid</span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token function css-1baulvz">yarn</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">add</span><span class="token plain css-1baulvz"> -D nodemon</span></div></pre><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">I&#x27;m going to explain what each package will handle shortly.</p><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">The next step is to setup our server with apollo and mongoose.
Create a <strong class="css-0">db.js</strong> file in your <strong class="css-0">/src</strong> directory and add the following configuration code to connect to your
<strong class="css-0">mongodb</strong> database:</p><br/><div class="bar bg-black z-10 flex justify-between pr-4 overflow-hidden"><div class="btns"></div><div class="my-auto flex"><img src="/images/icons/JS.svg" alt="js" class="w-6 h-6 mr-4"/><p class="name text-gray-500 text-base font-sans font-bold" style="color:#FFDE31">src/db.js</p></div></div><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="language-js prism-code language-javascript css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> mongoose </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;mongoose&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> </span><span class="token constant css-1baulvz">MONGO_CONNECTION</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;mongodb://localhost:27017/fileUploads&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">export</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">default</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token keyword css-1baulvz">async</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">function</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">connect</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">try</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token keyword css-1baulvz">await</span><span class="token plain css-1baulvz"> mongoose</span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">connect</span><span class="token punctuation css-1baulvz">(</span><span class="token constant css-1baulvz">MONGO_CONNECTION</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      useNewUrlParser</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token boolean css-1baulvz">true</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      useUnifiedTopology</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token boolean css-1baulvz">true</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">catch</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token plain css-1baulvz">err</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token console class-name css-1baulvz">console</span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">error</span><span class="token punctuation css-1baulvz">(</span><span class="token plain css-1baulvz">err</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span></div></pre><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Now create an <strong class="css-0">index.js</strong> file in your <strong class="css-0">/src</strong> directory and paste the following code start off your server on <style data-emotion-css="mwt03k">.css-mwt03k{color:var(--primary0);}.css-mwt03k:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="http://localhost:4000" class="css-mwt03k">http://localhost:4000</a>:</p><br/><div class="bar bg-black z-10 flex justify-between pr-4 overflow-hidden"><div class="btns"></div><div class="my-auto flex"><img src="/images/icons/JS.svg" alt="js" class="w-6 h-6 mr-4"/><p class="name text-gray-500 text-base font-sans font-bold" style="color:#FFDE31">src/index.js</p></div></div><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="language-js prism-code language-javascript css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> </span><span class="token maybe-class-name css-1baulvz">ApolloServer</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;apollo-server&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> typeDefs </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;./typeDefs&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> resolvers </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;./resolvers&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz">// Import your database configuration</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> connect </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;./db&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">export</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">default</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token keyword css-1baulvz">async</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">function</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">try</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token keyword css-1baulvz">await</span><span class="token plain css-1baulvz"> connect</span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">then</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token console class-name css-1baulvz">console</span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">log</span><span class="token punctuation css-1baulvz">(</span><span class="token string css-1baulvz">&quot;Connected ðŸš€ To MongoDB Successfully&quot;</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> server </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">new</span><span class="token plain css-1baulvz"> </span><span class="token class-name css-1baulvz">ApolloServer</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      typeDefs</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      resolvers</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    server</span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">listen</span><span class="token punctuation css-1baulvz">(</span><span class="token number css-1baulvz">4000</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token console class-name css-1baulvz">console</span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">log</span><span class="token punctuation css-1baulvz">(</span><span class="token template-string template-punctuation string css-1baulvz">`</span><span class="token template-string string css-1baulvz">ðŸš€ server running @ http://localhost:4000</span><span class="token template-string template-punctuation string css-1baulvz">`</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">catch</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token plain css-1baulvz">err</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token console class-name css-1baulvz">console</span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">error</span><span class="token punctuation css-1baulvz">(</span><span class="token plain css-1baulvz">err</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span></div></pre><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Next we&#x27;ll create our <strong class="css-0">resolvers</strong> and <strong class="css-0">typeDefs</strong> and put it in a separate file:</p><br/><div class="bar bg-black z-10 flex justify-between pr-4 overflow-hidden"><div class="btns"></div><div class="my-auto flex"><img src="/images/icons/JS.svg" alt="js" class="w-6 h-6 mr-4"/><p class="name text-gray-500 text-base font-sans font-bold" style="color:#FFDE31">src/typeDefs.js</p></div></div><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="language-js prism-code language-javascript css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> gql </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;apollo-server&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">export</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">default</span><span class="token plain css-1baulvz"> gql</span><span class="token template-string template-punctuation string css-1baulvz">`</span><span class="token template-string string css-1baulvz"></span></div><div class="token-line"><span class="token template-string string css-1baulvz">  type Query {</span></div><div class="token-line"><span class="token template-string string css-1baulvz">    hello: String</span></div><div class="token-line"><span class="token template-string string css-1baulvz">  }</span></div><div class="token-line"><span class="token template-string string css-1baulvz"></span><span class="token template-string template-punctuation string css-1baulvz">`</span><span class="token punctuation css-1baulvz">;</span></div></pre><div class="bar bg-black z-10 flex justify-between pr-4 overflow-hidden"><div class="btns"></div><div class="my-auto flex"><img src="/images/icons/JS.svg" alt="js" class="w-6 h-6 mr-4"/><p class="name text-gray-500 text-base font-sans font-bold" style="color:#FFDE31">/src/resolvers.js</p></div></div><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="language-js prism-code language-javascript css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token keyword module css-1baulvz">export</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">default</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token maybe-class-name css-1baulvz">Query</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token function-variable function css-1baulvz">hello</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;Hello world&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">;</span></div></pre><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Lol ðŸ˜… thats just a simple <strong class="css-0">Hello world</strong> Query.</p><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Now add a <strong class="css-0">dev</strong> script to your <strong class="css-0">package.json</strong> file to enable us start up our server.</p><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">You may be wondering why we&#x27;ve been using <strong class="css-0">ES6</strong> syntax without configuring babel and thats because of the <strong class="css-0"><style data-emotion-css="mwt03k">.css-mwt03k{color:var(--primary0);}.css-mwt03k:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://www.npmjs.com/package/esm" class="css-mwt03k">esm module</a></strong> we installed earlier.</p><br/><blockquote class="css-0"><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh"><strong class="css-0">esm</strong> is the worldâ€™s most advanced ECMAScript module loader. This fast, production ready, zero dependency loader is all you need to support ECMAScript modules in Node 6+.</p></blockquote><br/><div class="bar bg-black z-10 flex justify-between pr-4 overflow-hidden"><div class="btns"></div><div class="my-auto flex"><p class="text-white mr-2">$ </p><p class="name text-gray-500 text-base font-sans font-bold" style="color:#ffffff">package.json</p></div></div><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="language-json prism-code language-json css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token property css-1baulvz">&quot;name&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;apollo-upload&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token property css-1baulvz">&quot;main&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;src/index.js&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token property css-1baulvz">&quot;scripts&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token property css-1baulvz">&quot;dev&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;nodemon -r esm src/index.js&quot;</span><span class="token plain css-1baulvz"> </span><span class="token comment css-1baulvz">/* we are requiring the esm module </span></div><div class="token-line"><span class="token comment css-1baulvz">    with [-r] flag to transpile our es6 code */</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token property css-1baulvz">&quot;dependencies&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token property css-1baulvz">&quot;apollo-server&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;^2.11.0&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token property css-1baulvz">&quot;graphql&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;^14.6.0&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token property css-1baulvz">&quot;mongoose&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;^5.9.4&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token property css-1baulvz">&quot;esm&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;^3.2.25&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token property css-1baulvz">&quot;shortid&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;^2.2.15&quot;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token property css-1baulvz">&quot;devDependencies&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token property css-1baulvz">&quot;nodemon&quot;</span><span class="token operator css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;^2.0.2&quot;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span></div></pre><br/><div class="bar bg-black z-10 flex justify-between pr-4 overflow-hidden"><div class="btns"></div><div class="my-auto flex"><p class="text-white mr-2">$ </p><p class="name text-gray-500 text-base font-sans font-bold" style="color:#ffffff">bash</p></div></div><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="language-bash prism-code language-bash css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token function css-1baulvz">yarn</span><span class="token plain css-1baulvz"> dev</span></div></pre><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh"><style data-emotion-css="9whsf3">.css-9whsf3{max-width:100%;}</style><img src="/images/blog/file-uploads-with-apolloserver-2/start-server.png" alt="yarn start" class="css-9whsf3"/></p><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">We can see that out server is running on <strong class="css-0">localhost:4000</strong>. Let&#x27;s test our <strong class="css-0">Hello world</strong> query in out graphql playground.</p><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh"><style data-emotion-css="9whsf3">.css-9whsf3{max-width:100%;}</style><img src="/images/blog/file-uploads-with-apolloserver-2/hello.png" alt="Hello query" class="css-9whsf3"/></p><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">For server integrations that support file uploads (e.g. Express, hapi, Koa), Apollo Server enables file uploads by default. To enable file uploads reference the <strong class="css-0">Upload</strong> type in the schema passed to the Apollo Server construction.</p><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Now your <strong class="css-0">typeDefs</strong> file should look exactly like this:</p><div class="bar bg-black z-10 flex justify-between pr-4 overflow-hidden"><div class="btns"></div><div class="my-auto flex"><img src="/images/icons/JS.svg" alt="js" class="w-6 h-6 mr-4"/><p class="name text-gray-500 text-base font-sans font-bold" style="color:#FFDE31">src/typeDefs.js</p></div></div><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="language-js prism-code language-javascript css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> gql </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;apollo-server&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">export</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">default</span><span class="token plain css-1baulvz"> gql</span><span class="token template-string template-punctuation string css-1baulvz">`</span><span class="token template-string string css-1baulvz"></span></div><div class="token-line"><span class="token template-string string css-1baulvz">  type File {</span></div><div class="token-line"><span class="token template-string string css-1baulvz">    id: ID!</span></div><div class="token-line"><span class="token template-string string css-1baulvz">    filename: String!</span></div><div class="token-line"><span class="token template-string string css-1baulvz">    mimetype: String!</span></div><div class="token-line"><span class="token template-string string css-1baulvz">    path: String!</span></div><div class="token-line"><span class="token template-string string css-1baulvz">  }</span></div><div class="token-line"><span class="token template-string string css-1baulvz"></span></div><div class="token-line"><span class="token template-string string css-1baulvz">  type Query {</span></div><div class="token-line"><span class="token template-string string css-1baulvz">    hello: String</span></div><div class="token-line"><span class="token template-string string css-1baulvz">    files: [File!]</span></div><div class="token-line"><span class="token template-string string css-1baulvz">  }</span></div><div class="token-line"><span class="token template-string string css-1baulvz"></span></div><div class="token-line"><span class="token template-string string css-1baulvz">  type Mutation {</span></div><div class="token-line"><span class="token template-string string css-1baulvz">    uploadFile(file: Upload!): File</span></div><div class="token-line"><span class="token template-string string css-1baulvz">  }</span></div><div class="token-line"><span class="token template-string string css-1baulvz"></span><span class="token template-string template-punctuation string css-1baulvz">`</span><span class="token punctuation css-1baulvz">;</span></div></pre><blockquote class="css-0"><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Note: When using typeDefs, Apollo Server adds scalar Upload to your schema, so any existing declaration of scalar Upload in the type definitions should be removed. If you create your schema with makeExecutableSchema and pass it to ApolloServer constructor using the schema param, make sure to include scalar Upload.</p></blockquote><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">The server is going to return a rpomise that resolves an object. The object contains the following:</p><ol class="css-0"><style data-emotion-css="1g3n8wz">.css-1g3n8wz code{font-family:Menlo,monospace;background-color:#21262d;padding:3px 5px;border-radius:4px;font-size:16px;color:#9EFEFF;}</style><li class="css-1g3n8wz"><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh"><strong class="css-0">createReadStream:</strong> The upload stram manages straming the file(s) to a filesystemor any storage location of your choice.</p></li><li class="css-1g3n8wz"><p class="css-2o3vvh"><strong class="css-0">filename:</strong> The original name of the uploaded file(s)</p></li><li class="css-1g3n8wz"><p class="css-2o3vvh"><strong class="css-0">mimetype:</strong> The MIME type of the file(s) such as <style data-emotion-css="168yeei">.css-168yeei{background-color:var(--accent3);}.css-168yeei:hover{background-color:var(--accent2);}</style><em class="css-168yeei">image/jpg</em>, <em class="css-168yeei">application/json</em>, etc.</p></li><li class="css-1g3n8wz"><p class="css-2o3vvh"><strong class="css-0">encoding:</strong> The file encoding i.e <em class="css-168yeei">UTF-8</em></p></li></ol><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Now we are going to create a function that will process our file and pipe it into a directory.</p><br/><div class="bar bg-black z-10 flex justify-between pr-4 overflow-hidden"><div class="btns"></div><div class="my-auto flex"><img src="/images/icons/JS.svg" alt="js" class="w-6 h-6 mr-4"/><p class="name text-gray-500 text-base font-sans font-bold" style="color:#FFDE31">src/resolvers.js</p></div></div><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="language-js prism-code language-javascript css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> shortid </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;shortid&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> createWriteStream</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> mkdir </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;fs&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> </span><span class="token maybe-class-name css-1baulvz">File</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;./fileModel&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> </span><span class="token function-variable function css-1baulvz">storeUpload</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">async</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token parameter punctuation css-1baulvz">{</span><span class="token parameter css-1baulvz"> stream</span><span class="token parameter punctuation css-1baulvz">,</span><span class="token parameter css-1baulvz"> filename</span><span class="token parameter punctuation css-1baulvz">,</span><span class="token parameter css-1baulvz"> mimetype </span><span class="token parameter punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> id </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> shortid</span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">generate</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> path </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token template-string template-punctuation string css-1baulvz">`</span><span class="token template-string string css-1baulvz">images/</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz">${</span><span class="token template-string interpolation css-1baulvz">id</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz">}</span><span class="token template-string string css-1baulvz">-</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz">${</span><span class="token template-string interpolation css-1baulvz">filename</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz">}</span><span class="token template-string template-punctuation string css-1baulvz">`</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token comment css-1baulvz">// (createWriteStream) writes our file to the images directory</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">return</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">new</span><span class="token plain css-1baulvz"> </span><span class="token class-name css-1baulvz">Promise</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">(</span><span class="token parameter css-1baulvz">resolve</span><span class="token parameter punctuation css-1baulvz">,</span><span class="token parameter css-1baulvz"> reject</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    stream</span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">pipe</span><span class="token punctuation css-1baulvz">(</span><span class="token function css-1baulvz">createWriteStream</span><span class="token punctuation css-1baulvz">(</span><span class="token plain css-1baulvz">path</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">on</span><span class="token punctuation css-1baulvz">(</span><span class="token string css-1baulvz">&quot;finish&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">resolve</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> id</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> path</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> filename</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> mimetype </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">on</span><span class="token punctuation css-1baulvz">(</span><span class="token string css-1baulvz">&quot;error&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> reject</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> </span><span class="token function-variable function css-1baulvz">processUpload</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">async</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token parameter css-1baulvz">upload</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> createReadStream</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> filename</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> mimetype </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">await</span><span class="token plain css-1baulvz"> upload</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> stream </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">createReadStream</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> file </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">await</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">storeUpload</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> stream</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> filename</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> mimetype </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">return</span><span class="token plain css-1baulvz"> file</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">export</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">default</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token maybe-class-name css-1baulvz">Query</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token function-variable function css-1baulvz">hello</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;Hello world&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token maybe-class-name css-1baulvz">Mutation</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token function-variable function css-1baulvz">uploadFile</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">async</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token parameter css-1baulvz">_</span><span class="token parameter punctuation css-1baulvz">,</span><span class="token parameter css-1baulvz"> </span><span class="token parameter punctuation css-1baulvz">{</span><span class="token parameter css-1baulvz"> file </span><span class="token parameter punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token comment css-1baulvz">// Creates an images folder in the root directory</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token function css-1baulvz">mkdir</span><span class="token punctuation css-1baulvz">(</span><span class="token string css-1baulvz">&quot;images&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> recursive</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token boolean css-1baulvz">true</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token parameter css-1baulvz">err</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">        </span><span class="token keyword css-1baulvz">if</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token plain css-1baulvz">err</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">throw</span><span class="token plain css-1baulvz"> err</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token comment css-1baulvz">// Process upload</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> upload </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">await</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">processUpload</span><span class="token punctuation css-1baulvz">(</span><span class="token plain css-1baulvz">file</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token keyword css-1baulvz">return</span><span class="token plain css-1baulvz"> upload</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">;</span></div></pre><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">For the demo below i&#x27;m going to use <strong class="css-0">Altair</strong> which is a graphql playground and it&#x27;s very efficient for file uploads.</p><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh"><style data-emotion-css="9whsf3">.css-9whsf3{max-width:100%;}</style><img src="/images/blog/file-uploads-with-apolloserver-2/upload.gif" alt="file upload demo" class="css-9whsf3"/></p><br/><style data-emotion-css="1o4q193">.css-1o4q193{font-family:inherit;line-height:1.125;font-weight:400;margin-bottom:1rem;margin-top:2.9rem;font-size:38px;}</style><h2 class="css-1o4q193">Saving to database(mongodb)</h2><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">We used <strong class="css-0">file system</strong> to handle our file uploads because of the following reasons:</p><ul class="css-0"><style data-emotion-css="1g3n8wz">.css-1g3n8wz code{font-family:Menlo,monospace;background-color:#21262d;padding:3px 5px;border-radius:4px;font-size:16px;color:#9EFEFF;}</style><li class="css-1g3n8wz"><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh"><strong class="css-0">Performance can be better than when you do it in a database</strong>. To justify this, if you store large files in DB, then it may slow down the performance because a simple query to retrieve the list of files or filename will also load the file data if you used Select <!-- -->*<!-- --> in your query. In a file system, accessing a file is quite simple and light weight.</p></li><li class="css-1g3n8wz"><p class="css-2o3vvh"><strong class="css-0">Saving the files and downloading them in the file system is much simpler</strong> than it is in a database since a simple &quot;Save As&quot; function will help you out. Downloading can be done by addressing a URL with the location of the saved file.</p></li><li class="css-1g3n8wz"><p class="css-2o3vvh"><strong class="css-0">Migrating the data is an easy process</strong>. You can just copy and paste the folder to your desired destination while ensuring that write permissions are provided to your destination.
... <style data-emotion-css="mwt03k">.css-mwt03k{color:var(--primary0);}.css-mwt03k:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://dzone.com/articles/which-is-better-saving-files-in-database-or-in-fil" class="css-mwt03k">Read more</a></p></li></ul><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">In the future i&#x27;m going to show you how to query the files from our <strong class="css-0">images</strong> directory through the file path specified in the database.</p><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">We are going to create our database <strong class="css-0">schema</strong> and save it in a <strong class="css-0">src/fileModel.js</strong> file.</p><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Your code should look like:</p><br/><div class="bar bg-black z-10 flex justify-between pr-4 overflow-hidden"><div class="btns"></div><div class="my-auto flex"><img src="/images/icons/JS.svg" alt="js" class="w-6 h-6 mr-4"/><p class="name text-gray-500 text-base font-sans font-bold" style="color:#FFDE31">src/fileModel.js</p></div></div><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="language-js prism-code language-javascript css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> </span><span class="token maybe-class-name css-1baulvz">Schema</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> model </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;mongoose&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> fileSchema </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">new</span><span class="token plain css-1baulvz"> </span><span class="token class-name css-1baulvz">Schema</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  filename</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token known-class-name class-name css-1baulvz">String</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  mimetype</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token known-class-name class-name css-1baulvz">String</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  path</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token known-class-name class-name css-1baulvz">String</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">export</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">default</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">model</span><span class="token punctuation css-1baulvz">(</span><span class="token string css-1baulvz">&quot;File&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> fileSchema</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span></div></pre><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Next step is to make use our <strong class="css-0">file schema</strong>.</p><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Your <strong class="css-0">src/resolvers.js</strong> code should look like this:</p><div class="bar bg-black z-10 flex justify-between pr-4 overflow-hidden"><div class="btns"></div><div class="my-auto flex"><img src="/images/icons/JS.svg" alt="js" class="w-6 h-6 mr-4"/><p class="name text-gray-500 text-base font-sans font-bold" style="color:#FFDE31">src/resolvers.js</p></div></div><style data-emotion-css="ntkack">.css-ntkack{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;}.css-ntkack .changed{color:rgb(255,238,128);}.css-ntkack .deleted{color:rgba(239,83,80,0.56);}.css-ntkack .inserted{color:rgb(173,219,103);}.css-ntkack .comment{color:rgb(179,98,255);font-style:italic;}.css-ntkack .punctuation{color:rgb(255,255,255);}.css-ntkack .constant{color:rgb(255,98,140);}.css-ntkack .string,.css-ntkack .url{color:rgb(165,255,144);}.css-ntkack .variable{color:rgb(255,238,128);}.css-ntkack .number,.css-ntkack .boolean{color:rgb(255,98,140);}.css-ntkack .attr-name{color:rgb(255,180,84);}.css-ntkack .keyword,.css-ntkack .operator,.css-ntkack .property,.css-ntkack .namespace,.css-ntkack .tag,.css-ntkack .selector,.css-ntkack .doctype{color:rgb(255,157,0);}.css-ntkack .builtin,.css-ntkack .char,.css-ntkack .constant,.css-ntkack .function,.css-ntkack .class-name{color:rgb(250,208,0);}</style><style data-emotion-css="164t1yn">.css-164t1yn{font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}</style><style data-emotion-css="18jbzje">.css-18jbzje{color:#9EFEFF;background-color:#21262d;padding:18px;border-radius:7px;font-family:'Fira Code',monospace;margin:10px 0;over-flow:scroll;max-height:80vh;font-family:Menlo,monospace;background-color:#21262d;font-size:16px;}.css-18jbzje .changed{color:rgb(255,238,128);}.css-18jbzje .deleted{color:rgba(239,83,80,0.56);}.css-18jbzje .inserted{color:rgb(173,219,103);}.css-18jbzje .comment{color:rgb(179,98,255);font-style:italic;}.css-18jbzje .punctuation{color:rgb(255,255,255);}.css-18jbzje .constant{color:rgb(255,98,140);}.css-18jbzje .string,.css-18jbzje .url{color:rgb(165,255,144);}.css-18jbzje .variable{color:rgb(255,238,128);}.css-18jbzje .number,.css-18jbzje .boolean{color:rgb(255,98,140);}.css-18jbzje .attr-name{color:rgb(255,180,84);}.css-18jbzje .keyword,.css-18jbzje .operator,.css-18jbzje .property,.css-18jbzje .namespace,.css-18jbzje .tag,.css-18jbzje .selector,.css-18jbzje .doctype{color:rgb(255,157,0);}.css-18jbzje .builtin,.css-18jbzje .char,.css-18jbzje .constant,.css-18jbzje .function,.css-18jbzje .class-name{color:rgb(250,208,0);}</style><pre class="language-js prism-code language-javascript css-18jbzje"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> shortid </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;shortid&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> createWriteStream</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> mkdir </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;fs&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token comment css-1baulvz">// import our model</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">import</span><span class="token plain css-1baulvz"> </span><span class="token maybe-class-name css-1baulvz">File</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">from</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;./fileModel&quot;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> </span><span class="token function-variable function css-1baulvz">storeUpload</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">async</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token parameter punctuation css-1baulvz">{</span><span class="token parameter css-1baulvz"> stream</span><span class="token parameter punctuation css-1baulvz">,</span><span class="token parameter css-1baulvz"> filename</span><span class="token parameter punctuation css-1baulvz">,</span><span class="token parameter css-1baulvz"> mimetype </span><span class="token parameter punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> id </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> shortid</span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">generate</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> path </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token template-string template-punctuation string css-1baulvz">`</span><span class="token template-string string css-1baulvz">images/</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz">${</span><span class="token template-string interpolation css-1baulvz">id</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz">}</span><span class="token template-string string css-1baulvz">-</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz">${</span><span class="token template-string interpolation css-1baulvz">filename</span><span class="token template-string interpolation interpolation-punctuation punctuation css-1baulvz">}</span><span class="token template-string template-punctuation string css-1baulvz">`</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">return</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">new</span><span class="token plain css-1baulvz"> </span><span class="token class-name css-1baulvz">Promise</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">(</span><span class="token parameter css-1baulvz">resolve</span><span class="token parameter punctuation css-1baulvz">,</span><span class="token parameter css-1baulvz"> reject</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    stream</span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">pipe</span><span class="token punctuation css-1baulvz">(</span><span class="token function css-1baulvz">createWriteStream</span><span class="token punctuation css-1baulvz">(</span><span class="token plain css-1baulvz">path</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">on</span><span class="token punctuation css-1baulvz">(</span><span class="token string css-1baulvz">&quot;finish&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">resolve</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> id</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> path</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> filename</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> mimetype </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">on</span><span class="token punctuation css-1baulvz">(</span><span class="token string css-1baulvz">&quot;error&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> reject</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> </span><span class="token function-variable function css-1baulvz">processUpload</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">async</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token parameter css-1baulvz">upload</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> createReadStream</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> filename</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> mimetype </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">await</span><span class="token plain css-1baulvz"> upload</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> stream </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">createReadStream</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> file </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">await</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">storeUpload</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> stream</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> filename</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> mimetype </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">return</span><span class="token plain css-1baulvz"> file</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword module css-1baulvz">export</span><span class="token plain css-1baulvz"> </span><span class="token keyword module css-1baulvz">default</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token maybe-class-name css-1baulvz">Query</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token function-variable function css-1baulvz">hello</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&quot;Hello world&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token maybe-class-name css-1baulvz">Mutation</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token function-variable function css-1baulvz">uploadFile</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">async</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token parameter css-1baulvz">_</span><span class="token parameter punctuation css-1baulvz">,</span><span class="token parameter css-1baulvz"> </span><span class="token parameter punctuation css-1baulvz">{</span><span class="token parameter css-1baulvz"> file </span><span class="token parameter punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token function css-1baulvz">mkdir</span><span class="token punctuation css-1baulvz">(</span><span class="token string css-1baulvz">&quot;images&quot;</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"> recursive</span><span class="token punctuation css-1baulvz">:</span><span class="token plain css-1baulvz"> </span><span class="token boolean css-1baulvz">true</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token parameter css-1baulvz">err</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token arrow operator css-1baulvz">=&gt;</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">        </span><span class="token keyword css-1baulvz">if</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token plain css-1baulvz">err</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">throw</span><span class="token plain css-1baulvz"> err</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token keyword css-1baulvz">const</span><span class="token plain css-1baulvz"> upload </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz">await</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">processUpload</span><span class="token punctuation css-1baulvz">(</span><span class="token plain css-1baulvz">file</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token comment css-1baulvz">// save our file to the mongodb</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token keyword css-1baulvz">await</span><span class="token plain css-1baulvz"> </span><span class="token maybe-class-name css-1baulvz">File</span><span class="token punctuation css-1baulvz">.</span><span class="token method function property-access css-1baulvz">create</span><span class="token punctuation css-1baulvz">(</span><span class="token plain css-1baulvz">upload</span><span class="token punctuation css-1baulvz">)</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">      </span><span class="token keyword css-1baulvz">return</span><span class="token plain css-1baulvz"> upload</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">,</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span><span class="token punctuation css-1baulvz">;</span></div></pre><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Complete code <style data-emotion-css="mwt03k">.css-mwt03k{color:var(--primary0);}.css-mwt03k:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://github.com/DNature/apollo-upload" class="css-mwt03k">https://github.com/DNature/apollo-upload</a></p><br/><hr class="css-0"/><br/><style data-emotion-css="2o3vvh">.css-2o3vvh{color:var(--theme-ui-colors-text,var(--text));font-family:system-ui,"Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-weight:400;line-height:1.5;margin:1.5rem 0;font-size:21px;}.css-2o3vvh code{background-color:var(--accent1);font-family:Menlo,monospace;color:var(--gray4);margin:0 2px;}</style><p class="css-2o3vvh">Now you now understand how file uploads work in <strong class="css-0">Apollo server 2.0.</strong> I hope to see you next time ðŸ˜€</p><br/><style data-emotion-css="1k7sbs7">.css-1k7sbs7{font-family:inherit;line-height:1.125;font-weight:700;margin-bottom:1rem;margin-top:2.5rem;font-size:24px;}</style><h3 class="css-1k7sbs7">Happy Codding ðŸ¤“</h3></div></article></div><footer class="before before-2 mt-16 relative" style="justify-self:flex-start;background-color:#4d5254"><div class="container pt-12 pb-20 lg:grid grid-cols-8 gap-6"><div class="col-span-2 grid grid-cols-8"><img src="/images/icons/logo.svg" alt="Footer logo" class="col-span-2"/><div class="col-span-6"><h2 class="text-xl font-bold text-white">Divine Hycenth</h2><p class="text-g-25">Â© Copyright 2020</p><blockquote></blockquote></div></div><div class="col-span-2  text-center lg:text-left mt-8 lg:mt-0"><h2 class="text-xl font-bold text-white">Menu</h2><a class="font-bold block hover:text-g-25 false" href="/">Home</a><a class="font-bold block text-white hover:text-g-50 false" href="/about/">About</a><a class="font-bold block text-white hover:text-g-50 text-white" href="/blog/">Blog</a><a class="font-bold block text-white hover:text-g-50 false" href="/works/">Works</a><a class="font-bold block text-white hover:text-g-50 false" href="/contact/">Contact</a></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="anonymous">{"props":{"pageProps":{}},"page":"/blog/2020-02-02_file-uploads-with-apolloserver-2","query":{},"buildId":"mQTtxJh6cp0PLSlqOD3x2","runtimeConfig":{},"nextExport":true,"autoExport":true,"isFallback":false,"dynamicIds":["IdFE","R77S","rtqS"]}</script><script crossorigin="anonymous" nomodule="">!function(){var e=document,t=e.createElement("script");if(!("noModule"in t)&&"onbeforeload"in t){var n=!1;e.addEventListener("beforeload",function(e){if(e.target===t)n=!0;else if(!e.target.hasAttribute("nomodule")||!n)return;e.preventDefault()},!0),t.type="module",t.src=".",e.head.appendChild(t),t.remove()}}();</script><script crossorigin="anonymous" nomodule="" src="/_next/static/runtime/polyfills-97205fd133897d19fc22.js"></script><script async="" data-next-page="/blog/2020-02-02_file-uploads-with-apolloserver-2" src="/_next/static/mQTtxJh6cp0PLSlqOD3x2/pages/blog/2020-02-02_file-uploads-with-apolloserver-2.js" crossorigin="anonymous" nomodule=""></script><script async="" data-next-page="/blog/2020-02-02_file-uploads-with-apolloserver-2" src="/_next/static/mQTtxJh6cp0PLSlqOD3x2/pages/blog/2020-02-02_file-uploads-with-apolloserver-2.module.js" crossorigin="anonymous" type="module"></script><script async="" data-next-page="/_app" src="/_next/static/mQTtxJh6cp0PLSlqOD3x2/pages/_app.js" crossorigin="anonymous" nomodule=""></script><script async="" data-next-page="/_app" src="/_next/static/mQTtxJh6cp0PLSlqOD3x2/pages/_app.module.js" crossorigin="anonymous" type="module"></script><script async="" src="/_next/static/chunks/95b64a6e.320b368289cb716b3186.js" crossorigin="anonymous" nomodule=""></script><script async="" src="/_next/static/chunks/95b64a6e.320b368289cb716b3186.module.js" crossorigin="anonymous" type="module"></script><script async="" src="/_next/static/chunks/70b165ca.5eabe1f989279afc56a7.js" crossorigin="anonymous" nomodule=""></script><script async="" src="/_next/static/chunks/70b165ca.5eabe1f989279afc56a7.module.js" crossorigin="anonymous" type="module"></script><script async="" src="/_next/static/chunks/26.0149a36d0df17236e20b.js" crossorigin="anonymous" nomodule=""></script><script src="/_next/static/runtime/webpack-941e8ad857d576e3bd94.js" async="" crossorigin="anonymous" nomodule=""></script><script src="/_next/static/runtime/webpack-6b61ba7e8cc83693bf8f.module.js" async="" crossorigin="anonymous" type="module"></script><script src="/_next/static/chunks/framework.9549779569dd0a6219bc.js" async="" crossorigin="anonymous" nomodule=""></script><script src="/_next/static/chunks/framework.9549779569dd0a6219bc.module.js" async="" crossorigin="anonymous" type="module"></script><script src="/_next/static/chunks/commons.de4c4fb9dacae54a7459.js" async="" crossorigin="anonymous" nomodule=""></script><script src="/_next/static/chunks/commons.38ae1a63b556c62a43bb.module.js" async="" crossorigin="anonymous" type="module"></script><script src="/_next/static/runtime/main-daf344f70497c211d11c.js" async="" crossorigin="anonymous" nomodule=""></script><script src="/_next/static/runtime/main-bff67df7d47595de3d7b.module.js" async="" crossorigin="anonymous" type="module"></script><script src="/_next/static/chunks/79a3735623e6ec13153dc6c81bde6dd3a2ce1fd5.f7a4071bcb08fcded521.js" async="" crossorigin="anonymous" nomodule=""></script><script src="/_next/static/chunks/79a3735623e6ec13153dc6c81bde6dd3a2ce1fd5.cb733fe248004940673c.module.js" async="" crossorigin="anonymous" type="module"></script><script src="/_next/static/chunks/bc2128e0aae8cc24d1deb12f225fceae6d5349d9.a04bc2561052b96b655b.js" async="" crossorigin="anonymous" nomodule=""></script><script src="/_next/static/chunks/bc2128e0aae8cc24d1deb12f225fceae6d5349d9.43d63eaf1e9ba971f319.module.js" async="" crossorigin="anonymous" type="module"></script><script src="/_next/static/chunks/363a1f4813caa0a77838ebfcb6ec3f2bb88305a2.8f04404f8468a6b7d3a4.js" async="" crossorigin="anonymous" nomodule=""></script><script src="/_next/static/chunks/363a1f4813caa0a77838ebfcb6ec3f2bb88305a2.0f1a051ba58adbbdf01c.module.js" async="" crossorigin="anonymous" type="module"></script><script src="/_next/static/mQTtxJh6cp0PLSlqOD3x2/_buildManifest.js" async="" crossorigin="anonymous" nomodule=""></script><script src="/_next/static/mQTtxJh6cp0PLSlqOD3x2/_buildManifest.module.js" async="" crossorigin="anonymous" type="module"></script><script src="/_next/static/mQTtxJh6cp0PLSlqOD3x2/_ssgManifest.js" async="" crossorigin="anonymous" nomodule=""></script><script src="/_next/static/mQTtxJh6cp0PLSlqOD3x2/_ssgManifest.module.js" async="" crossorigin="anonymous" type="module"></script></body></html>